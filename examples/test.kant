principal Alice,Bob


Bob know{
    fresh pk1:PrivateKey;
    pbkl=PUB_GEN(pk1);
    fresh bit:BitString;
    j=SIGN(bit)with pk1;
    test=CONCAT(j,pbkl);
}

Bob -> Alice:test

Alice know{
    fresh na:Nonce;
    fresh pk:PrivateKey;
    pbk=PUB_GEN(pk);
    const k:SymmetricKey;
    const k1:SymmetricKey;
    const auth:BitString;
    h=HASH(na);
    conc=CONCAT(h,pk,na);
    enc_k=PKE_ENC(k)with pbk;
    enc=AEAD_ENC(h)with {k,auth};
    j1=SIGN(na)with pk;
    resi=SPLIT(test);
    
     dec=AEAD_DEC(enc)with {k,auth};
     s=SIGN_VERIF(resi[0]) with resi[1];
     sum=CONCAT(enc,k,enc_k,j1,auth);
    //v=AEAD_ENC(na) with {k,ch};
    //ch=ENC(conc[3])with k;
    
}

Alice->Bob:sum

Bob know{
    fresh nb:Nonce;
    const fake:SymmetricKey;
    const loc:BitString;
    
    //pbk1=PUB_GEN(pk1);
    retrive=SPLIT(sum);
    f=AEAD_DEC(retrive[0])with {retrive[1],nb};
    
    

}